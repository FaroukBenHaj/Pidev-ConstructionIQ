{"ast":null,"code":"import _asyncToGenerator from \"C:/Users/medfa/Desktop/Cycle_ingenieur/Esprit/4SAE5/Projet_PI/Pidev-ConstructionIQ/FrontEnd/Dashboard/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { __decorate } from \"tslib\";\nimport { Component } from \"@angular/core\";\nexport let AppComponent = class AppComponent {\n  constructor(kc) {\n    this.kc = kc;\n    this.authorized = false;\n    this.loading = true;\n  }\n  ngOnInit() {\n    var _this = this;\n    return _asyncToGenerator(function* () {\n      yield _this.kc.init();\n      const roles = _this.kc.getRoles();\n      const port = window.location.port;\n      if (roles.includes('ADMIN')) {\n        if (port !== '4201') {\n          window.location.href = 'http://localhost:4201';\n          return; // Prevent further execution\n        }\n\n        _this.authorized = true;\n      } else if (roles.includes('USER')) {\n        if (port !== '4200') {\n          window.location.href = 'http://localhost:4200';\n          return;\n        }\n        _this.authorized = true;\n      } else {\n        _this.authorized = false; // No permitted role\n      }\n\n      _this.loading = false;\n    })();\n  }\n};\nAppComponent = __decorate([Component({\n  selector: 'app-root',\n  template: `\n    <ng-container *ngIf=\"authorized; else loadingOrError\">\n      <router-outlet></router-outlet>\n    </ng-container>\n    <ng-template #loadingOrError>\n      <p *ngIf=\"loading\">Loading...</p>\n      <p *ngIf=\"!loading && !authorized\">You do not have access to this application.</p>\n    </ng-template>\n  `\n})], AppComponent);","map":{"version":3,"names":["Component","AppComponent","constructor","kc","authorized","loading","ngOnInit","_this","_asyncToGenerator","init","roles","getRoles","port","window","location","includes","href","__decorate","selector","template"],"sources":["C:\\Users\\medfa\\Desktop\\Cycle_ingenieur\\Esprit\\4SAE5\\Projet_PI\\Pidev-ConstructionIQ\\FrontEnd\\Dashboard\\src\\app\\app.component.ts"],"sourcesContent":["import {Component, OnInit} from \"@angular/core\";\nimport {KeycloakService} from \"./Services/Keycloak/Keycloak.service\";\n\n@Component({\n  selector: 'app-root',\n  template: `\n    <ng-container *ngIf=\"authorized; else loadingOrError\">\n      <router-outlet></router-outlet>\n    </ng-container>\n    <ng-template #loadingOrError>\n      <p *ngIf=\"loading\">Loading...</p>\n      <p *ngIf=\"!loading && !authorized\">You do not have access to this application.</p>\n    </ng-template>\n  `,\n})\nexport class AppComponent implements OnInit {\n  authorized = false;\n  loading = true;\n\n  constructor(private kc: KeycloakService) {}\n\n  async ngOnInit() {\n    await this.kc.init();\n    const roles = this.kc.getRoles();\n    const port = window.location.port;\n\n    if (roles.includes('ADMIN')) {\n      if (port !== '4201') {\n        window.location.href = 'http://localhost:4201';\n        return; // Prevent further execution\n      }\n      this.authorized = true;\n    } else if (roles.includes('USER')) {\n      if (port !== '4200') {\n        window.location.href = 'http://localhost:4200';\n        return;\n      }\n      this.authorized = true;\n    } else {\n      this.authorized = false; // No permitted role\n    }\n\n    this.loading = false;\n  }\n}\n"],"mappings":";;AAAA,SAAQA,SAAS,QAAe,eAAe;AAexC,WAAMC,YAAY,GAAlB,MAAMA,YAAY;EAIvBC,YAAoBC,EAAmB;IAAnB,KAAAA,EAAE,GAAFA,EAAE;IAHtB,KAAAC,UAAU,GAAG,KAAK;IAClB,KAAAC,OAAO,GAAG,IAAI;EAE4B;EAEpCC,QAAQA,CAAA;IAAA,IAAAC,KAAA;IAAA,OAAAC,iBAAA;MACZ,MAAMD,KAAI,CAACJ,EAAE,CAACM,IAAI,EAAE;MACpB,MAAMC,KAAK,GAAGH,KAAI,CAACJ,EAAE,CAACQ,QAAQ,EAAE;MAChC,MAAMC,IAAI,GAAGC,MAAM,CAACC,QAAQ,CAACF,IAAI;MAEjC,IAAIF,KAAK,CAACK,QAAQ,CAAC,OAAO,CAAC,EAAE;QAC3B,IAAIH,IAAI,KAAK,MAAM,EAAE;UACnBC,MAAM,CAACC,QAAQ,CAACE,IAAI,GAAG,uBAAuB;UAC9C,OAAO,CAAC;;;QAEVT,KAAI,CAACH,UAAU,GAAG,IAAI;OACvB,MAAM,IAAIM,KAAK,CAACK,QAAQ,CAAC,MAAM,CAAC,EAAE;QACjC,IAAIH,IAAI,KAAK,MAAM,EAAE;UACnBC,MAAM,CAACC,QAAQ,CAACE,IAAI,GAAG,uBAAuB;UAC9C;;QAEFT,KAAI,CAACH,UAAU,GAAG,IAAI;OACvB,MAAM;QACLG,KAAI,CAACH,UAAU,GAAG,KAAK,CAAC,CAAC;;;MAG3BG,KAAI,CAACF,OAAO,GAAG,KAAK;IAAC;EACvB;CACD;AA7BYJ,YAAY,GAAAgB,UAAA,EAZxBjB,SAAS,CAAC;EACTkB,QAAQ,EAAE,UAAU;EACpBC,QAAQ,EAAE;;;;;;;;;CASX,CAAC,C,EACWlB,YAAY,CA6BxB","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}